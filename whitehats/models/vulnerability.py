"""Vulnerability finding models."""

from dataclasses import dataclass, field
from datetime import datetime
from enum import Enum
from typing import Optional


class Severity(Enum):
    INFO = "info"
    LOW = "low"
    MEDIUM = "medium"
    HIGH = "high"
    CRITICAL = "critical"


@dataclass
class Vulnerability:
    """Represents a discovered vulnerability."""

    name: str
    severity: Severity
    module: str
    description: str
    target_url: str
    evidence: str = ""
    request_detail: Optional[str] = None
    response_detail: Optional[str] = None
    remediation: str = ""
    cwe_id: Optional[str] = None
    timestamp: str = field(default_factory=lambda: datetime.now().isoformat())

    def to_dict(self) -> dict:
        return {
            "name": self.name,
            "severity": self.severity.value,
            "module": self.module,
            "description": self.description,
            "target_url": self.target_url,
            "evidence": self.evidence,
            "request_detail": self.request_detail,
            "response_detail": self.response_detail,
            "remediation": self.remediation,
            "cwe_id": self.cwe_id,
            "timestamp": self.timestamp,
        }
